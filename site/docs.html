---
layout: default
head_include_raw: |
  <script src="/aoc2024/static/js/api.js"></script>
---

<script>
  fetch("{{ site.BaseUrl }}/static/mermaid/UI.mermaid")
    .then(r => r.text())
    .then(t => document.getElementById("mermaidUI").innerHTML = t);
  fetch("{{ site.BaseUrl }}/static/mermaid/OAuth.mermaid")
    .then(r => r.text())
    .then(t => document.getElementById("mermaidOAuth").innerHTML = t);
</script>

<section id="swagger">
      <h2>
        <a href="{{ site.BackendBaseUrl }}/swagger" target="_blank">API Definition (hosted on backend)</a>
      </h2>
</section>

<section id="godocs">
  <h2>
    <a href="{{ site.BackendBaseUrl }}/godocs" target="_blank">Go Documentation (hosted on backend)</a>
  </h2>
</section>

<section>
    <h2>Diagram of UI flow on the index Page</h2>
    <pre id="mermaidUI" class="mermaid">
    </pre>
</section>

<section>
    <h2>Diagram of OAuth Flow</h2>
    <pre id="mermaidOAuth" class="mermaid">
    </pre>
</section>

<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>

<script>
document.addEventListener("DOMContentLoaded", function() {
  // check backend status
  document.body.classList.add("busy");
  sendToApi("GET", "/api/public/info")
  // update backend information
  .then(info => {
    const backendEl= document.getElementById("backend");
    backendEl.classList.remove("backend-not-available");
    backendEl.classList.add("backend-available");
  })
  .catch(err => {
    const backendEl= document.getElementById("backend");
    backendEl.classList.add("backend-not-available");
    backendEl.classList.remove("backend-available");

    const swaggerEl = document.getElementById("swagger");
    swaggerEl.classList.add("disabled");

    const godocsEl= document.getElementById("godocs");
    godocsEl.classList.add("disabled");
  })
  .finally(() => {
    document.body.classList.remove("busy");
  });
});
</script>